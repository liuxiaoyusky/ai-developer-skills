# 测试方案：{任务名称}

**生成时间**: {YYYY-MM-DD HH:mm}
**任务来源**: tasks.md → 当前任务
**执行次数**: {N}（首次/第N次执行）

---

## 📊 代码审查（Linus 5层分析）

**审查时间**: {YYYY-MM-DD HH:mm}
**审查评分**: {X}/10

### Layer 1: 数据结构分析
- **核心数据模型**: {识别主要数据结构}
- **数据流向**: {追踪数据如何流动}
- **潜在问题**: {标记数据结构问题}

### Layer 2: 特殊情况识别
- **边界条件**: {列举需要测试的边界}
- **错误处理**: {检查异常处理路径}
- **特殊情况**: {空值、null、超长输入等}

### Layer 3: 复杂度审查
- **嵌套深度**: {X}层 {⚠️ 如果>3}
- **抽象层次**: {评估抽象是否合理}
- **圈复杂度**: {评估代码复杂度}

### Layer 4: 破坏性分析
- **API兼容性**: {验证是否有破坏性变更}
- **行为变更**: {检查是否改变现有行为}
- **迁移成本**: {评估升级难度}

### Layer 5: 实用性验证
- **真实问题**: {确认是否解决实际问题}
- **过度工程**: {评估是否过度设计}
- **实用性评分**: {X}/10

---

## 改进建议

### P0 - 必须修复
- [ ] {问题描述} → {影响}

### P1 - 强烈建议
- [ ] {问题描述} → {影响}

### P2 - 可选优化
- [ ] {问题描述} → {影响}

---

## 1. 单元测试

**目标**: 验证核心逻辑正确性
**工具**: {自动检测：pytest/jest/etc}
**状态**: ⏳ PENDING / ✅ PASSED / ❌ FAILED

### 测试项
- [ ] 核心函数的输入输出
- [ ] 边界条件和异常处理
- [ ] 状态变化逻辑
- [ ] 数据转换逻辑

### 执行记录
**首次执行**:
- **执行时间**: {待执行}
- **命令**: {待检测}
- **结果**: {待执行}
- **输出**: {待执行}

**最新执行**:
- **执行时间**: {YYYY-MM-DD HH:mm:ss}
- **框架**: {pytest/jest/etc}
- **命令**: `{实际执行命令}`
- **结果**: {通过/失败统计}
- **输出**:
```
{完整测试输出}
```

---

## 2. 集成/功能测试

**目标**: 验证功能正常工作
**状态**: ⏳ PENDING / ✅ PASSED / ❌ FAILED

### 测试项
- [ ] 手动测试功能流程
- [ ] 验证与外部系统的交互
- [ ] 测试 API 接口
- [ ] 验证数据持久化

### 执行记录
**首次执行**:
- **执行时间**: {待执行}
- **测试方法**: {待决定}
- **结果**: {待执行}

**最新执行**:
- **执行时间**: {YYYY-MM-DD HH:mm:ss}
- **测试方法**: {手动/自动化脚本}
- **结果**: {成功/失败详情}
- **测试场景**:
  - [ ] {场景1}: {通过/失败}
  - [ ] {场景2}: {通过/失败}
  - [ ] {场景3}: {通过/失败}

---

## 3. 启动和运行测试

**目标**: 确保应用可以正常启动
**状态**: ⏳ PENDING / ✅ PASSED / ❌ FAILED

### 验证项
- [ ] 应用可以启动无报错
- [ ] 前端页面可以正常加载
- [ ] 关键功能可以访问
- [ ] 环境变量正确配置

### 执行记录
**首次执行**:
- **执行时间**: {待执行}
- **启动方式**: {待决定}
- **结果**: {待执行}

**最新执行**:
- **执行时间**: {YYYY-MM-DD HH:mm:ss}
- **启动方式**: {npm run dev / python app.py / etc}
- **启动日志**:
```
{应用启动日志}
```
- **验证结果**:
  - [ ] 启动成功: {是/否}
  - [ ] 端口监听: {端口号}
  - [ ] 健康检查: {通过/失败}

---

## 4. 行为验证测试

**目标**: 验证功能符合预期行为
**状态**: ⏳ PENDING / ✅ PASSED / ❌ FAILED

### 测试场景

#### 正常场景
- [ ] **场景1**: {描述正常使用流程}
  - **输入**: {有效输入}
  - **预期输出**: {期望结果}
  - **实际结果**: {待测试}
  - **状态**: {⏳/✅/❌}

#### 异常场景
- [ ] **场景2**: {描述异常情况}
  - **输入**: {无效输入}
  - **预期行为**: {错误处理}
  - **实际结果**: {待测试}
  - **状态**: {⏳/✅/❌}

#### 边界场景
- [ ] **场景3**: {描述边界条件}
  - **输入**: {极限值}
  - **预期行为**: {边界处理}
  - **实际结果**: {待测试}
  - **状态**: {⏳/✅/❌}

### 执行记录
**最新执行**:
- **执行时间**: {YYYY-MM-DD HH:mm:ss}
- **测试方式**: {手动/自动化}
- **结果汇总**:
  - 正常场景: {X/Y} 通过
  - 异常场景: {X/Y} 通过
  - 边界场景: {X/Y} 通过

---

## 5. 性能/回归测试

**目标**: 验证性能指标或防止功能退化
**状态**: ⏳ PENDING / ✅ PASSED / ❌ FAILED / ⏭️ SKIPPED

### 性能指标
- [ ] **响应时间**: {目标 < X ms} → {实际: Y ms}
- [ ] **内存占用**: {目标 < Y MB} → {实际: Z MB}
- [ ] **并发处理**: {目标 N 请求/秒} → {实际: M 请求/秒}
- [ ] **数据库查询**: {目标 < X ms} → {实际: Y ms}

### 回归检查
- [ ] **现有测试套件**: {通过/失败}
- [ ] **关键功能验证**: {无退化}
- [ ] **性能基准对比**: {无显著下降}

### 执行记录
**最新执行**:
- **执行时间**: {YYYY-MM-DD HH:mm:ss}
- **跳过原因**: {如适用}
- **性能数据**:
  - 响应时间: {X} ms {✅/⚠️/❌}
  - 内存占用: {Y} MB {✅/⚠️/❌}
  - 并发能力: {Z} 请求/秒 {✅/⚠️/❌}
- **回归检查**: {通过/失败}

---

## 📋 测试汇总

**最后更新**: {YYYY-MM-DD HH:mm}

| 测试类别 | 状态 | 通过/总计 | 执行时间 |
|---------|------|----------|---------|
| 1. 单元测试 | {⏳/✅/❌} | {X/Y} | {Z}s |
| 2. 集成测试 | {⏳/✅/❌} | {X/Y} | {Z}s |
| 3. 启动测试 | {⏳/✅/❌} | {通过/失败} | {Z}s |
| 4. 行为测试 | {⏳/✅/❌} | {X/Y} | {Z}s |
| 5. 性能测试 | {⏳/✅/❌/⏭️} | {X/Y} | {Z}s |

**总体结果**: {⏳ 待执行 / ✅ 所有测试通过 / ❌ 部分失败 (需要修复)}

---

## 🔧 Debug 会话记录

### Debug Session #{N}
**时间**: {YYYY-MM-DD HH:mm}
**触发**: {测试类别} - {测试名称} 失败

**失败详情**:
- **错误**: {错误消息}
- **文件**: {文件路径:行号}
- **堆栈**:
```
{错误堆栈跟踪}
```

**dev-debug 分析**:
- **方法**: {5 Whys / 第一性原理}
- **根因**: {识别的根本原因}
- **解决方案**: {提供的解决方案}

**修复实施**:
- **修改文件**: {文件路径}
- **修改内容**:
```diff
- {旧代码}
+ {新代码}
```

**验证结果**:
- [ ] 代码已修改
- [ ] 重新测试通过
- [ ] 回归测试通过

---

## ✅ 验收标准

- [ ] 所有核心测试通过（单元 + 集成）
- [ ] 无 P0 级别代码问题
- [ ] 性能指标达标（如适用）
- [ ] 所有 Debug 会话已关闭
- [ ] 代码审查评分 ≥ {X}/10

**任务完成判断**:
- ✅ 所有测试通过 → 可以标记任务完成
- ❌ 有 P0 问题 → 必须修复
- ⚠️ 有 P1 问题 → 建议修复，可记录技术债务

---

## 📝 备注

{任何额外的测试说明、特殊配置、依赖服务等}

---

## 📎 相关文件

- **任务详情**: [task-details.md](./task-details.md)
- **任务列表**: [tasks.md](./tasks.md)
- **代码审查**: [dev-review](../dev-review/SKILL.md)
- **调试技能**: [dev-debug](../dev-debug/SKILL.md)
