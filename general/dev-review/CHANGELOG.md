# Linus Code Review - 更新日志

## v1.1.0 - 默认行为 + Ralph Wiggum 智能集成

### 🚀 新特性

#### 1. 默认行为模式

**问题**: 用户需要每次显式触发代码审查

**解决方案**: 添加"默认行为模式"章节，使 Linus 思维成为自动行为

**触发场景**（自动启用）：
- ✅ 代码审查请求（"审查这段代码"、"代码质量怎么样"）
- ✅ 代码相关请求（修改代码、重构建议、API 设计）
- ✅ 技术决策（"这个设计怎么样？"、"应该用 A 还是 B？"）

**作为默认思维模式**：
- 编写代码时：追求简洁、消除特殊情况
- 审查代码时：检查数据结构、复杂度、破坏性
- 设计 API 时：确保向后兼容
- 重构代码时：应用"好品味"原则

**禁止的行为**：
- ❌ 编写过度抽象的代码
- ❌ 引入破坏性变更而不警告
- ❌ 忽略边界情况处理
- ❌ 过度工程化

#### 2. Ralph Wiggum 智能集成

**问题**: 复杂任务需要多次迭代，但用户不知道何时使用 Ralph Wiggum

**解决方案**: 在 Linus Code Review 中添加智能触发机制

**判断标准**：

**任务规模指标**：
- 文件数量: 5+ 个文件
- 代码行数: 500+ 行代码
- 任务数量: 3+ 个相关任务
- 预估时间: 30分钟+

**复杂度指标**：
- 系统性重构（整个模块/子系统）
- 多阶段实现（实现-测试-修复循环）
- 依赖管理（多个依赖/集成点）
- 破坏性变更（需要分阶段迁移）

**Linus 的实用主义判断**：
```
✅ "这代码太垃圾了，需要重写一大块"
✅ "这个 API 改动影响面太大，得分阶段做"
✅ "这个功能实现太复杂，需要多次试错"
✅ "修复这个 bug 需要改很多地方"

❌ "这只是个小改动"（< 100行，1-2个文件）
```

**标准建议模板**：
```markdown
## 🚀 Linus 建议：启动 Ralph Wiggum Loop

**为什么？**
- 需要重构 [X] 个文件
- 估计需要 [Y] 行代码变更
- 包含 [Z] 个相关任务

**如何启动？**
1. 准备任务文件：创建 TASKS.md
2. 运行：`/ralph-wiggum` 或 "开始 ralph"
3. Ralph 会持续迭代，直到所有任务完成

**预期效果：**
- Ralph 自动：实现 → 测试 → 修复 → 迭代
- 每次迭代都会应用 Linus 的代码质量标准
- 全部任务完成后，Linus 进行最终审查
```

**协作模式**：
```
Linus Code Review (首次审查)
  ↓ 发现大规模重构需求
建议启动 Ralph Wiggum
  ↓ Ralph 自动迭代实现
Linus Code Review (最终审查)
  ↓ 验证代码质量
✅ 完成
```

#### 3. 项目级配置示例

**新增文件**: `CLAUDE.project.example.md`

**用途**:
- 展示如何在项目中让 Linus 风格成为默认
- 提供完整的项目级配置模板
- 包含具体应用示例和决策树

**关键内容**：
- 项目默认代码审查风格
- 与其他技能的协作决策树
- 项目特定配置（代码风格、API 设计）
- 质量标准（品味评分维度）
- 快速参考（Linus 的 7 个关键问题）

---

### 📝 文件变更

#### 修改的文件

1. **SKILL.md**
   - ✅ 添加"默认行为模式"章节（~60 行）
   - ✅ 添加"复杂任务自动化 - Ralph Wiggum 集成"章节（~120 行）
   - ✅ 更新 frontmatter description（反映新特性）
   - ✅ 总行数：366 → ~560 行

2. **README.md**
   - ✅ 添加"新特性"章节（说明默认行为和智能集成）
   - ✅ 强调自动触发场景

3. **.claude-plugin/marketplace.json**
   - ✅ 更新 dev-review description
   - ✅ 反映"默认启用"和"智能建议"特性

#### 新增的文件

1. **CLAUDE.project.example.md**
   - ✅ 项目级配置示例
   - ✅ 完整的使用指南
   - ✅ 自定义配置说明

---

### 🎯 使用场景对比

#### 之前（v1.0.0）

```
用户: "审查这段代码"
AI: 普通代码审查

用户: "帮我重构这个模块"（10个文件）
AI: 直接开始重构（可能遗漏相关文件）
```

#### 现在（v1.1.0）

```
用户: "审查这段代码"
AI: Linus Code Review（5层分析 + 品味评分）

用户: "帮我重构这个模块"（10个文件）
AI:
🚀 Linus 建议：启动 Ralph Wiggum Loop
- 需要重构 10 个文件
- 估计需要 800+ 行代码变更
- 建议让 AI 自动迭代

 TASKS.md 示例：
 - [ ] 重构模块 A
 - [ ] 重构模块 B
 - [ ] 迁移所有调用点
 - [ ] 运行测试
 - [ ] Linus 最终审查
```

---

### 🔧 技术实现

#### 自动触发机制

**在 SKILL.md 中定义**：
```markdown
## 默认行为模式

**重要**: 当用户进行以下任一操作时，自动启用 Linus Code Review 模式：

### 自动触发场景
1. 代码审查请求
2. 代码相关请求
3. 技术决策
...
```

**AI 理解**：
- 当用户说"审查代码"、"设计 API"、"如何实现"时
- AI 自动应用 Linus 的 5 层分析框架
- 无需显式调用 `/dev-review`

#### Ralph Wiggum 智能建议

**在 SKILL.md 中定义**：
```markdown
## 复杂任务自动化 - Ralph Wiggum 集成

### 判断标准
**任务规模指标**:
- 文件数量: 5+ 个文件
- 代码行数: 500+ 行代码
...
```

**AI 理解**：
- 在代码审查/设计评估时
- 自动检查是否符合"复杂任务"标准
- 如果符合，自动建议使用 ralph-wiggum

---

### 📊 效果预期

#### 对用户体验的影响

**之前**：
- ❌ 需要记住触发 Linus Review
- ❌ 不知道何时使用 Ralph Wiggum
- ❌ 复杂任务手动迭代效率低

**现在**：
- ✅ 自动应用 Linus 质量标准
- ✅ 智能建议使用 Ralph Wiggum
- ✅ 复杂任务自动迭代，高效完成

#### 对代码质量的影响

**之前**：
- 代码质量取决于是否显式触发审查
- 可能遗漏破坏性变更
- 可能出现过度工程化

**现在**：
- 所有代码自动应用 Linus 标准
- 自动检测破坏性变更
- 追求简洁和实用

---

### 🚀 未来改进方向

#### v1.2.0 计划

1. **语言特定模式**
   - C/C++ 模式（Linus 的专长）
   - Python 模式（简洁优先）
   - JavaScript/TypeScript 模式

2. **团队配置**
   - 团队级编码标准
   - 自定义评分权重
   - 集成 CI/CD

3. **历史追踪**
   - 追踪品味评分变化
   - 代码质量趋势分析
   - 改进建议追踪

---

### 📚 相关资源

- [SKILL.md](./SKILL.md) - 完整技能定义
- [README.md](./README.md) - 用户文档
- [CLAUDE.project.example.md](./CLAUDE.project.example.md) - 项目级配置示例
- [ralph-wiggum](../ralph-wiggum/) - 自动迭代技能
- [debug](../debug/) - 根因分析技能
- [first-principles](../first-principles/) - 第一性原理思维

---

**更新日期**: 2025-01-26
**版本**: v1.1.0
**关键词**: 默认行为、智能集成、Ralph Wiggum、项目级配置

---

**"Talk is cheap. Show me the code."** - Linus Torvalds
